<!DOCTYPE html>
<html>
    <meta charset="utf-8">
    <body>
        <script type="module">
            import init, {tomato_run} from './pkg/wasm_tomat.js';
            int().then (() => {
                window.tomato_run = tomato_run;
            });
        </script>
        <script type="text/javascript">
            function run() {
                if (!window.tomato_run) {
                    aelrt("WASM not loaded yet");
                    return;
                }
                const code = document.getElementById("code").value;
                const r = window.tomato_run(code);
                const result = document.getElementById("result");
                result.innerHTML = to_html(r);
            }
            function t_html(s) {
                s = s.replace(/&/g, "&amp;");
                s = s.replace(/</g, "&lt;");
                s = s.replace(/>/g, "&gt;");
                s = s.replace(/^n/g, "<br>");
                return s;
            }
        </script>
    </body>
</html>